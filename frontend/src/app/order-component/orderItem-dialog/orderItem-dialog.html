<h2 mat-dialog-title>
  <mat-icon>edit</mat-icon>
  Edit Order Item
</h2>

<mat-dialog-content [formGroup]="orderForm" class="dialog-content">

  <!-- Product Dropdown -->
  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Product</mat-label>
    <mat-select formControlName="product_id">
      <mat-option *ngFor="let product of products" [value]="product.productId">
        {{ product.name }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="orderForm.get('product_id')?.hasError('required')">
      Product is required
    </mat-error>
  </mat-form-field>

  <!-- Price and Quantity Row -->
  <div class="row">
    <!-- Unit Price -->
    <mat-form-field appearance="outline" class="half-width">
      <mat-label>Unit Price</mat-label>
      <input matInput type="number" formControlName="price" min="0.01" step="0.01">
      <mat-error *ngIf="orderForm.get('price')?.hasError('required')">
        Price is required
      </mat-error>
      <mat-error *ngIf="orderForm.get('price')?.hasError('min')">
        Price must be greater than 0
      </mat-error>
    </mat-form-field>

    <!-- Quantity -->
    <mat-form-field appearance="outline" class="half-width">
      <mat-label>Quantity</mat-label>
      <input matInput type="number" formControlName="quantity" min="1" [max]="selectedProductStock">
      <mat-error *ngIf="orderForm.get('quantity')?.hasError('required')">
        Quantity required
      </mat-error>
      <mat-error *ngIf="orderForm.get('quantity')?.hasError('min')">
        Quantity must be at least 1
      </mat-error>
      <mat-error *ngIf="orderForm.get('quantity')?.hasError('max')">
        Cannot exceed available stock
      </mat-error>
    </mat-form-field>
  </div>

</mat-dialog-content>

<mat-dialog-actions align="end" class="dialog-actions">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button mat-raised-button color="primary" (click)="onSave()" [disabled]="!orderForm.valid">Save</button>
</mat-dialog-actions>
